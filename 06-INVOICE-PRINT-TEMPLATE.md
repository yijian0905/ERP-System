# 06-INVOICE-PRINT-TEMPLATE.md

# 統一發票列印格式規範

> **Module Purpose**: 定義傳統商業發票的統一列印樣式，適用於商品銷售、訂閱服務等不同業務場景

---

## 重要說明

### 列印發票 vs e-Invoice 提交

| 項目 | 列印發票 (本文檔) | e-Invoice 提交 |
|------|------------------|----------------|
| **用途** | 給客戶的紙本/PDF | 提交至 LHDN MyInvois |
| **TIN** | ❌ 不需要 | ✅ 必須 |
| **BRN** | ❌ 不需要 | ✅ 必須 |
| **MSIC** | ❌ 不需要 | ✅ 必須 |
| **分類代碼** | ❌ 不需要 | ✅ 必須 |
| **QR Code** | ⚪ 可選 (驗證後可加) | ✅ 驗證後生成 |
| **UUID** | ⚪ 可選 (驗證後可加) | ✅ 驗證後生成 |
| **55 欄位** | ❌ 不需要 | ✅ 必須 |

**本文檔僅定義列印用的傳統發票格式，e-Invoice 提交規範請參考 E-Invoice.md**

---

## 1. 統一佈局結構

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    A. 表頭區域                           │   │
│  │  (公司 Logo、公司名稱、發票標題)                          │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌──────────────────────┐  ┌──────────────────────────────┐   │
│  │  B. 公司資訊          │  │  C. 發票資訊                 │   │
│  │  (地址、電話、Email)   │  │  (發票號、日期、付款期限)    │   │
│  └──────────────────────┘  └──────────────────────────────┘   │
│                                                                 │
│  ┌──────────────────────┐  ┌──────────────────────────────┐   │
│  │  D. 客戶資訊          │  │  E. 配送資訊 (商品適用)      │   │
│  │  (名稱、地址、聯絡人)  │  │                              │   │
│  └──────────────────────┘  └──────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    F. 明細表格                           │   │
│  │  (商品/服務項目)                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    G. 金額彙總                           │   │
│  │  (小計、折扣、稅額、總計)                                 │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    H. 付款資訊                           │   │
│  │  (銀行帳號、付款方式)                                    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    I. 頁尾                              │   │
│  │  (備註、條款、致謝)                                      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 各區塊詳細規格

### A. 表頭區域 (Header)

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   [COMPANY LOGO]                              INVOICE           │
│    120×60 px                                  發票              │
│                                                                 │
│   COMPANY NAME SDN BHD                                          │
│   公司中文名稱 (可選)                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**發票類型標題:**

| 類型 | 英文 | 中文 |
|------|------|------|
| 一般發票 | INVOICE | 發票 |
| 報價單 | QUOTATION | 報價單 |
| 形式發票 | PROFORMA INVOICE | 形式發票 |
| 貸項通知 | CREDIT NOTE | 貸項通知單 |
| 借項通知 | DEBIT NOTE | 借項通知單 |
| 收據 | RECEIPT | 收據 |

---

### B. 公司資訊 (Company Info)

```
┌─────────────────────────────────────────┐
│                                         │
│  COMPANY NAME SDN BHD                   │
│  (123456-A)                             │
│                                         │
│  No. 123, Jalan Example,                │
│  Taman Business Park,                   │
│  50000 Kuala Lumpur,                    │
│  Malaysia                               │
│                                         │
│  Tel: +60 3-1234 5678                   │
│  Email: sales@company.com               │
│  Website: www.company.com               │
│                                         │
│  SST Reg: W10-1234-56789012 (如適用)    │
│                                         │
└─────────────────────────────────────────┘
```

| 欄位 | 必要性 |
|------|--------|
| 公司名稱 | ✅ 必要 |
| 公司註冊號 | ✅ 必要 |
| 完整地址 | ✅ 必要 |
| 聯絡電話 | ✅ 必要 |
| Email | ⚪ 可選 |
| 網站 | ⚪ 可選 |
| SST 註冊號 | ⚪ 可選 (已註冊者建議顯示) |

---

### C. 發票資訊 (Invoice Info)

```
┌─────────────────────────────────────────┐
│                                         │
│  Invoice No:     INV-2025-00001         │
│  發票號碼                                │
│                                         │
│  Date:           26 Dec 2025            │
│  日期                                    │
│                                         │
│  Due Date:       26 Jan 2026            │
│  付款期限                                │
│                                         │
│  Payment Terms:  Net 30                 │
│  付款條件                                │
│                                         │
│  Your Ref:       PO-2025-00123          │
│  您的參考號                              │
│                                         │
└─────────────────────────────────────────┘
```

| 欄位 | 必要性 |
|------|--------|
| 發票號碼 | ✅ 必要 |
| 發票日期 | ✅ 必要 |
| 付款期限 | ⚪ 可選 |
| 付款條件 | ⚪ 可選 |
| 客戶參考號 | ⚪ 可選 |

---

### D. 客戶資訊 (Customer Info)

```
┌─────────────────────────────────────────┐
│  BILL TO / 客戶:                         │
│                                         │
│  CUSTOMER COMPANY SDN BHD               │
│                                         │
│  No. 456, Jalan Customer,               │
│  47800 Petaling Jaya,                   │
│  Selangor, Malaysia                     │
│                                         │
│  Attn: Mr. Ahmad bin Abdullah           │
│  Tel: +60 3-8765 4321                   │
│                                         │
└─────────────────────────────────────────┘
```

| 欄位 | 必要性 |
|------|--------|
| 客戶名稱 | ✅ 必要 |
| 地址 | ✅ 必要 |
| 聯絡人 | ⚪ 可選 |
| 電話 | ⚪ 可選 |

---

### E. 配送資訊 (Shipping Info) - 僅商品銷售

```
┌─────────────────────────────────────────┐
│  SHIP TO / 配送地址:                     │
│                                         │
│  Warehouse B,                           │
│  No. 789, Jalan Industrial,             │
│  41200 Klang, Selangor                  │
│                                         │
│  Delivery Date: 28 Dec 2025             │
│                                         │
└─────────────────────────────────────────┘
```

---

### F. 明細表格 (Line Items)

#### 商品銷售版本:

```
┌─────┬─────────────────────────────┬───────┬───────────┬───────────┐
│ No. │ Description                 │  Qty  │Unit Price │  Amount   │
│ 項次 │ 商品說明                    │  數量  │   單價    │   金額    │
├─────┼─────────────────────────────┼───────┼───────────┼───────────┤
│  1  │ iPhone 15 Pro Max 256GB     │   2   │  5,499.00 │ 10,998.00 │
│     │ 智慧手機                     │       │           │           │
├─────┼─────────────────────────────┼───────┼───────────┼───────────┤
│  2  │ Screen Protector            │   2   │     99.00 │    198.00 │
│     │ 螢幕保護貼                   │       │           │           │
├─────┼─────────────────────────────┼───────┼───────────┼───────────┤
│  3  │ Phone Case - Black          │   2   │    149.00 │    298.00 │
│     │ 手機殼 - 黑色                │       │           │           │
└─────┴─────────────────────────────┴───────┴───────────┴───────────┘
```

**欄位寬度:**

| 欄位 | 寬度 | 對齊 |
|------|------|------|
| No. | 8% | 置中 |
| Description | 47% | 左對齊 |
| Qty | 10% | 置中 |
| Unit Price | 15% | 右對齊 |
| Amount | 20% | 右對齊 |

#### 服務發票版本:

```
┌─────┬─────────────────────────────┬─────────────┬───────────┬───────────┐
│ No. │ Description                 │   Period    │   Rate    │  Amount   │
│ 項次 │ 服務說明                    │   期間      │   費率    │   金額    │
├─────┼─────────────────────────────┼─────────────┼───────────┼───────────┤
│  1  │ System Development          │ Dec 2025    │ 200/hour  │ 16,000.00 │
│     │ 系統開發 (80 hours)          │             │           │           │
├─────┼─────────────────────────────┼─────────────┼───────────┼───────────┤
│  2  │ Project Management          │ Dec 2025    │ 300/hour  │  6,000.00 │
│     │ 專案管理 (20 hours)          │             │           │           │
└─────┴─────────────────────────────┴─────────────┴───────────┴───────────┘
```

#### 訂閱服務版本:

```
┌─────┬─────────────────────────────┬─────────────┬───────────┬───────────┐
│ No. │ Description                 │   Period    │ Unit Price│  Amount   │
│ 項次 │ 訂閱說明                    │   計費期間   │   單價    │   金額    │
├─────┼─────────────────────────────┼─────────────┼───────────┼───────────┤
│  1  │ Enterprise Plan (10 users)  │ Jan 2025    │ 299/user  │  2,990.00 │
│     │ 企業方案                     │             │           │           │
├─────┼─────────────────────────────┼─────────────┼───────────┼───────────┤
│  2  │ Additional Storage 100GB    │ Jan 2025    │  50/pack  │    100.00 │
│     │ 額外儲存空間 (2 packs)       │             │           │           │
└─────┴─────────────────────────────┴─────────────┴───────────┴───────────┘
```

---

### G. 金額彙總 (Amount Summary)

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                                    Subtotal / 小計:  11,494.00  │
│                                                                 │
│                                    Discount / 折扣:    -500.00  │
│                                                                 │
│                            ─────────────────────────────────    │
│                                                                 │
│                               SST (10%) / 銷售稅:     1,099.40  │
│                                                                 │
│                            ═════════════════════════════════    │
│                                                                 │
│                               TOTAL / 總計:          12,093.40  │
│                               (MYR)                             │
│                                                                 │
│                            ═════════════════════════════════    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**顯示規則:**
- 小計：必顯示
- 折扣：有折扣時才顯示
- 稅額：有稅時顯示 (標明稅種和稅率)
- 總計：必顯示，粗體強調

**多稅種情況:**
```
                               Sales Tax (10%):          899.40
                               Service Tax (8%):         200.00
                               ─────────────────────────────
                               Total Tax / 稅額合計:   1,099.40
```

---

### H. 付款資訊 (Payment Info)

```
┌─────────────────────────────────────────────────────────────────┐
│  PAYMENT DETAILS / 付款資訊:                                    │
│                                                                 │
│  Please make payment to / 請將款項匯入:                         │
│                                                                 │
│  Bank:          Maybank                                         │
│  Account Name:  Company Name Sdn Bhd                            │
│  Account No:    5123 4567 8901                                  │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│  Or scan to pay / 或掃碼付款:   [DuitNow QR Code]               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### I. 頁尾 (Footer)

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  NOTES / 備註:                                                  │
│  ____________________________________________________________   │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│  TERMS & CONDITIONS / 條款:                                     │
│  1. Goods sold are not returnable.                             │
│  2. Interest at 1.5% per month on overdue accounts.            │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│  This is a computer generated invoice. No signature required.  │
│  此為電腦生成之發票，無需簽名。                                  │
│                                                                 │
│                     Thank you for your business!                │
│                          感謝您的惠顧！                          │
│                                                                 │
│                         Page 1 of 1                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. 業務場景變體

### 3.1 場景對照表

| 場景 | 表頭標題 | 配送資訊 | 特殊區塊 |
|------|----------|----------|----------|
| **商品銷售** | INVOICE | ✅ 顯示 | - |
| **服務發票** | INVOICE | ❌ 隱藏 | - |
| **訂閱服務** | INVOICE | ❌ 隱藏 | 訂閱詳情 |
| **報價單** | QUOTATION | ⚪ 可選 | 報價有效期 |
| **貸項通知** | CREDIT NOTE | ❌ 隱藏 | 原始發票參考 |
| **借項通知** | DEBIT NOTE | ❌ 隱藏 | 原始發票參考 |

---

### 3.2 訂閱服務特殊區塊

在客戶資訊後增加：

```
┌─────────────────────────────────────────────────────────────────┐
│  SUBSCRIPTION DETAILS / 訂閱詳情:                                │
│                                                                 │
│  Subscription ID:    SUB-2024-00456                             │
│  Plan:               Enterprise Plan                            │
│  Billing Cycle:      Monthly / 月付                             │
│  Billing Period:     01 Jan 2025 - 31 Jan 2025                 │
│  Next Billing:       01 Feb 2025                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### 3.3 貸項/借項通知特殊區塊

```
┌─────────────────────────────────────────────────────────────────┐
│  REFERENCE / 參考:                                              │
│                                                                 │
│  Original Invoice:   INV-2025-00001                             │
│  原始發票號碼                                                    │
│                                                                 │
│  Original Date:      26 Dec 2025                                │
│  原始發票日期                                                    │
│                                                                 │
│  Reason / 原因:                                                 │
│  Return of defective goods / 瑕疵品退貨                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. 列印規格

### 4.1 紙張與邊距

| 屬性 | 規格 |
|------|------|
| 紙張尺寸 | A4 (210 × 297 mm) |
| 邊距 | 上下左右各 15 mm |
| 內容區域 | 180 × 267 mm |

### 4.2 字體規格

| 元素 | 大小 | 樣式 |
|------|------|------|
| 發票標題 | 20-24pt | Bold |
| 公司名稱 | 14-16pt | Bold |
| 區塊標題 | 11pt | Bold |
| 內文 | 10pt | Regular |
| 表格標題 | 10pt | Bold |
| 表格內容 | 9-10pt | Regular |
| 總計金額 | 12-14pt | Bold |
| 頁尾 | 8-9pt | Regular |

**字體選擇:** Noto Sans (支援英文、中文、馬來文)

### 4.3 顏色

| 元素 | 顏色 |
|------|------|
| 主要文字 | #1A1A1A |
| 次要文字 | #666666 |
| 表頭背景 | #F5F5F5 |
| 表格邊框 | #CCCCCC |
| 總計強調 | #000000 |

---

## 5. 狀態標記 (可選)

### 付款狀態印章

```
      ╭───────────────────╮
      │                   │
      │       PAID        │
      │      已付款        │
      │                   │
      │   26 Dec 2025     │
      │                   │
      ╰───────────────────╯
      
   (45° 旋轉，透明度 30%)
```

| 狀態 | 顏色 | 文字 |
|------|------|------|
| 已付款 | 綠色 #4CAF50 | PAID / 已付款 |
| 逾期 | 紅色 #F44336 | OVERDUE / 逾期 |
| 已取消 | 灰色 #9E9E9E | CANCELLED / 已取消 |

---

## 6. 可選：e-Invoice 驗證資訊

當發票已通過 LHDN 驗證後，**可選擇**加入：

```
┌─────────────────────────────────────────────────────────────────┐
│  e-INVOICE VERIFIED ✓                                          │
│                                                                 │
│  ┌───────────┐  This invoice has been validated by LHDN        │
│  │  QR CODE  │  此發票已通過 LHDN 驗證                          │
│  │ 100×100px │                                                  │
│  └───────────┘  Validated: 26 Dec 2025, 14:32                   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**注意:** 此區塊僅在 e-Invoice 驗證通過後才可顯示，非必要元素。

---

## 7. 資料結構

### 7.1 發票列印資料

```typescript
interface PrintableInvoice {
  // 發票類型
  type: 'INVOICE' | 'QUOTATION' | 'PROFORMA' | 'CREDIT_NOTE' | 'DEBIT_NOTE' | 'RECEIPT';
  variant: 'PRODUCT_SALES' | 'SERVICE' | 'SUBSCRIPTION';
  
  // 發票資訊
  invoiceNumber: string;
  invoiceDate: Date;
  dueDate?: Date;
  paymentTerms?: string;
  customerRef?: string;
  
  // 公司資訊
  company: {
    name: string;
    nameSecondary?: string;  // 中文名
    registrationNo: string;
    address: string[];
    phone: string;
    email?: string;
    website?: string;
    sstNo?: string;
    logo?: string;
  };
  
  // 客戶資訊
  customer: {
    name: string;
    address: string[];
    attn?: string;
    phone?: string;
  };
  
  // 配送資訊 (商品銷售)
  shipping?: {
    address: string[];
    deliveryDate?: Date;
  };
  
  // 明細項目
  items: Array<{
    no: number;
    description: string;
    descriptionSecondary?: string;
    quantity: number;
    unit?: string;
    unitPrice: number;
    amount: number;
    period?: string;  // 服務/訂閱
  }>;
  
  // 金額
  amounts: {
    subtotal: number;
    discount?: number;
    taxes?: Array<{
      name: string;
      rate: number;
      amount: number;
    }>;
    total: number;
    currency: string;
  };
  
  // 付款資訊
  payment?: {
    bankName: string;
    accountName: string;
    accountNo: string;
    duitnowQR?: string;
  };
  
  // 訂閱資訊 (訂閱場景)
  subscription?: {
    id: string;
    plan: string;
    billingCycle: string;
    billingPeriod: string;
    nextBillingDate?: Date;
  };
  
  // 參考資訊 (貸項/借項)
  reference?: {
    originalInvoiceNo: string;
    originalInvoiceDate: Date;
    reason: string;
  };
  
  // 其他
  notes?: string;
  terms?: string[];
  
  // 狀態
  status?: 'PAID' | 'OVERDUE' | 'CANCELLED';
  
  // e-Invoice 驗證 (可選)
  eInvoiceValidation?: {
    validated: boolean;
    validatedAt?: Date;
    qrCodeUrl?: string;
  };
}
```

### 7.2 列印配置

```typescript
interface PrintConfig {
  // 語言
  language: {
    primary: 'en' | 'zh-TW' | 'ms';
    secondary?: 'en' | 'zh-TW' | 'ms';
  };
  
  // 顯示選項
  display: {
    showShippingInfo: boolean;
    showPaymentInfo: boolean;
    showPaymentQR: boolean;
    showNotes: boolean;
    showTerms: boolean;
    showStatus: boolean;
    showEInvoiceValidation: boolean;
  };
  
  // 品牌設定
  branding: {
    primaryColor?: string;
  };
}
```

---

## 8. 快速參考

### 欄位必要性總覽

| 區塊 | 必要欄位 | 可選欄位 |
|------|----------|----------|
| **表頭** | 公司名、發票標題 | Logo、中文名 |
| **公司資訊** | 名稱、註冊號、地址、電話 | Email、網站、SST號 |
| **發票資訊** | 發票號、日期 | 付款期限、條件、參考號 |
| **客戶資訊** | 名稱、地址 | 聯絡人、電話 |
| **明細** | 說明、數量、單價、金額 | 期間 |
| **金額** | 小計、總計 | 折扣、稅額 |
| **付款** | - | 銀行帳號、QR |
| **頁尾** | - | 備註、條款 |

### 場景區塊顯示

| 區塊 | 商品銷售 | 服務 | 訂閱 | 貸項通知 |
|------|----------|------|------|----------|
| 配送資訊 | ✅ | ❌ | ❌ | ❌ |
| 訂閱詳情 | ❌ | ❌ | ✅ | ❌ |
| 參考資訊 | ❌ | ❌ | ❌ | ✅ |
| 付款資訊 | ✅ | ✅ | ⚪ | ❌ |

---

*本規範定義傳統商業發票的統一列印格式。e-Invoice 提交所需的額外欄位 (TIN、BRN、MSIC、分類代碼等) 請參考 E-Invoice.md。*
